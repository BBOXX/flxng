<div class="container">
  <textarea cols="80"
            rows="10"
            #textareaRef
            placeholder="Enter '@' and start typing some name, e.g. 'Doe'"
            [(ngModel)]="text"></textarea>

  <!-- <input type="text" #inputRef> -->

  <ng-template #menuTemplate
               let-selectChoice="selectChoice">
    <!-- TODO: user MAT menu here! Loader may not be needed! -->
    <ul flxLoader
        [flxLoaderVisible]="loading"
        class="flx-selectable-list"
        [class.loader-only]="!choices.length && loading">

      <li *ngFor="let user of choices"
          class="flx-selectable-list-item"
          (click)="selectChoice(user)">
        <span title="{{user.name}}">{{user.name}}</span>
      </li>
    </ul>
  </ng-template>

  <flx-text-input-autocomplete [textInputElement]="textareaRef"
                               [menuTemplate]="menuTemplate"
                               triggerCharacter="@"
                               [findChoices]="getChoices"
                               [searchRegexp]="'^([-&.\\w]+ *){0,3}$'"
                               [getChoiceLabel]="getChoiceLabel"
                               [selectedChoices]="getSelectedChoices()"
                               (selectedChoicesChange)="onSelectedChoicesChange($event)"
                               (menuShown)="onMenuShown()"
                               (menuHidden)="onMenuHidden()"></flx-text-input-autocomplete>

  <flx-text-input-highlight #textInputHighlight
                            [tags]="mentions"
                            [textInputElement]="textareaRef"
                            (tagClick)="onHighlighTagClick($event)"
                            (tagMouseEnter)="onHighlightTagMouseEnter($event)"
                            (tagMouseLeave)="onHighlightTagMouseLeave($event)"></flx-text-input-highlight>
</div>