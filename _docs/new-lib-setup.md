## New lib setup
Generate new lib:

```bash
$ ng g library my-lib
```

### First steps after generating lib
- Go to `angular.json` and update selector prefix for library components, it defaults to 'lib'.

- Go to `package.json` (for my-lib) and update lib name and version (Add preffix for scoped packages for example).

- Building:
```bash
$ ng build my-lib
```

- While developing use the folloing command (so changes are reflected automatically - i.e. rebuilded): 
```bash
$ ng build my-lib --watch
```

### Updating TS paths
- Go to `tsconfig.json` (root) and update generated paths for the lib. By default it generated the following paths:
```json
"my-lib": [
  "dist/my-lib"
],
"my-lib/*": [
  "dist/my-lib/*"
]
```
However the generated paths seems to be unresolvable in some cases (even when adjusting TS `baseUrl`) and in my case I needed to change to the paths below in order to be able to import the lib module:
```json
"my-lib": [
  "../dist/my-lib"
],
"my-lib/*": [
  "../dist/my-lib/*"
]
```

These paths still point to the compiled version of the lib (dist), and even when building using `--watch` parameter we are still unable to serve the app that imports the lib and have the lib auto re-compiles simultaneously. 
In order to achieve that the following needs to be changed:
- Go to `projects/my-lib/src/lib/`, create `index.ts` file that exports all lib exports (begin with copying and adjusting `public-api.ts`). 

- Now update `public-api.ts` file so it exports all from the previously created `index.ts` (so we only need to keep `index.ts` file updated with new exports) file as follows:
```typescript
export * from './lib/index';
```

- Once `index.ts` file is created, update generated paths in `tsconfig.json` (root) to the following:
```json
"my-lib": [
  "../projects/my-lib/src/lib"
],
"my-lib/*": [
  "../projects/my-lib/src/lib/*"
]
```

This way we will mimick imports from the lib while developing, all by having auto reloading if code changes either in app or lib code. Also, nothing needs to be changed additionally once decided to publish the lib!
(In order to import lib code from `node_modules` (installed) while developing we just need to remove TS paths we created above).


### Development
- Go to generated lib component and update selector prefix, add HTML and SCSS files if needed and link them in the component.

- Go to `package.json` (for my-lib) and add missing peer dependencies (if any new added during development).

- Go to my-library module and import Angular Common module and other Angular modules used in the lib code. (NOT NEEDED!?)


### Publishing
- Update `package.json` of the lib with addl info like "license", "description", etc.

- Increment version of the lib in the `package.json` (update the main README page versions too)

- Build lib:
```bash
$ ng build my-lib
```

- Go to `dist/my-lib` and run:
```bash
$ npm publish --access=public
```

**NOTE:** If the library has a dependency on another library, that another library needs to be built first, and TS paths for that library should point to its dist folder (revert TS paths that are originally generated by Angular).
Also, the required library needs to be listed under `peerDependencies` in `package.json` file (for lib).


### Testing published
- Install the package as dev dependency (--save-dev)
- Comment out the TS path for the package
- Now the app will use installed version of the package


### Additional info
For additional info visit: 
https://angular.io/guide/creating-libraries
https://medium.com/@esanjiv/complete-beginner-guide-to-publish-an-angular-library-to-npm-d42343801660



## Versioning

### Bumping major versions
- Create new branch from the currently active one, e.g. `v2` from `v1` (development branch is obsolete)
- Update `package.json` files with new major version (all libs should have the same major version - in this example all libs should have 2.0.0 as the starting version)
- Update `peerDependencies` in `package.json` file (if any)
- When bumping versions in `package.json` file make sure also to update the latest lib version specified in the main README file
- Commit and push newly created branch
- Do the actual development for changes that caused the major version bumping
- Add change logs for all changes made
- Build and Publish all libs to NPM (Use `npm run build-libs` command to build all libs)
- Merge the newly created branch into `master` (make it public - Jenkins is listening `master` branch, and it's the default branch on GH)
- See also NPM official versioning guide: [semantic versioning](https://docs.npmjs.com/about-semantic-versioning)

### Bumping minor versions (minor features and bug fixes)
- Bump version in `package.json` file for the lib for which minor changes are made (see: [semantic versioning](https://docs.npmjs.com/about-semantic-versioning))
- Update the latest lib version specified in the main README file
- Do the actual development for changes that caused the minor version bumping
- Add change logs
- Build and Publish new lib version to NPM
- Merge the current branch into `master` (make it public - Jenkins is listening `master` branch, and it's the default branch on GH)